<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <title>D3 | L3 CSV Daten</title>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <style type="text/css">
        .barText {

        }

        #GE, #BS {
            fill : #000!important;
        }

        .axis { font-size: 10px; }
        .y.axis { font: 11px monospace; }

        .axis path,
        .axis line {
          fill: none;
          stroke: #000;
          shape-rendering: crispEdges;
        }

    </style>
</head>
<body>


    <div style="width:650px; margin:200px auto;padding:40px">
        <svg width="650" height="420" style="stroke-width: 0;"></svg>
    </div>


    <script>

        var datensatz = [];

        // var y = d3.scale.linear().range([420, 0]);
        var y = d3.scale.linear().domain([1, 410]).range([420, 0]);

        var yAxis = d3.svg.axis()
            .scale(y)
            .orient("right")
            .ticks(10);



        d3.csv("data/datensatz.csv", function(error, rows) {

                rows.forEach(function(d) {
                    datensatz.push({
                        name: d.ID,
                        value: +d.Rate
                    })
                });


                // Y-Achse, Alternative
                // y.domain([1, d3.max(rows, function(d) { return +d.Rate; })]);

                d3.select("svg").append("g")
                        .attr("class", "y axis")
                        .attr("transform", "translate(0,0)")
                        .call(yAxis);


                datensatz.forEach(function(d,i){
                    d3.select("svg").append("rect");
                    d3.selectAll( "rect" )
                        .data(datensatz)
                        .attr("height", function(d) {
                            return parseInt(d.value);
                        })

                        .attr( "y", function(d,i){
                            return 420 - parseInt(d.value);
                        })

                        .attr( "x", function(d,i){
                            return i * 25;
                        })
                        .attr( "width", 24)
                        .attr("fill", function(d, i) {
                            var rgbColor = "rgb(" + Math.round(d.value/410*118) + ", 0, "  + Math.round(d.value/410*255) + ")";
                            return rgbColor;
                        })

                        .attr("class", "bar");

                    d3.select("svg").append("text")
                        .text(d.name)
                        .attr("id", d.name)
                        .attr({"x": i*25+5, "y": 420-5})
                        .style({"fill" : "#fff","text-anchor": "start","font-size": "10px","font-family": "monospace"})
                        .attr("class", "barText");

                });

            });

    </script>

</body>
</html>
